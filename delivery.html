<!DOCTYPE html>
<html lang="ko">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Digital Bouquet - ì „ë‹¬í•˜ê¸°</title>
Â  Â  <script>
Â  Â  // Adobe Typekit ë¡œë” (ê¸°ì¡´ ìœ ì§€)
Â  Â  (function(d) {
Â  Â  Â  var config = {
Â  Â  Â  Â  kitId: 'bno4gef',
Â  Â  Â  Â  scriptTimeout: 3000,
Â  Â  Â  Â  async: true
Â  Â  Â  },
Â  Â  Â  h=d.documentElement,t=setTimeout(function(){h.className=h.className.replace(/\bwf-loading\b/g,"")+" wf-inactive";},config.scriptTimeout),tk=d.createElement("script"),f=false,s=d.getElementsByTagName("script")[0],a;h.className+=" wf-loading";tk.src='https://use.typekit.net/'+config.kitId+'.js';tk.async=true;tk.onload=tk.onreadystatechange=function(){a=this.readyState;if(f||a&&a!="complete"&&a!="loaded")return;f=true;clearTimeout(t);try{Typekit.load(config)}catch(e){}};s.parentNode.insertBefore(tk,s)
Â  Â  })(document);
Â  Â  </script>
Â  Â  <link rel="stylesheet" href="https://use.typekit.net/bno4gef.css">
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

Â  Â  <style>
Â  Â  Â  Â  /* --- ê¸°ë³¸ ë° ë¹„ë””ì˜¤ ìŠ¤íƒ€ì¼ --- */
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  background-color: #000;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  height: 100vh;
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  font-family: "pretendard", sans-serif;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  }

Â  Â  Â  Â  #video-background {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  object-fit: cover;
Â  Â  Â  Â  Â  Â  z-index: 0;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- UI ë° ì¤‘ì•™ ì •ë ¬ --- */
Â  Â  Â  Â  #delivery-ui-wrapper {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: flex-end;
Â  Â  Â  Â  Â  Â  z-index: 10;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- ê½ƒë‹¤ë°œ ë“œë˜ê·¸ ê°€ëŠ¥ ìš”ì†Œ (ì´ˆê¸° ìœ„ì¹˜ ìˆ˜ì •) --- */
Â  Â  Â  Â  #draggable-bouquet {
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  width: 40vw;
Â  Â  Â  Â  Â  Â  height: auto;
Â  Â  Â  Â  Â  Â  max-height: 80vh;
Â  Â  Â  Â  Â  Â  /* ì´ˆê¸° ìƒíƒœ: ë“œë˜ê·¸ ë¹„í™œì„±í™”, í¬ì¸í„° ì»¤ì„œ */
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  user-select: none;
Â  Â  Â  Â  Â  Â  /* [ìˆ˜ì •] ì™„ì „ í•˜ë‹¨ìœ¼ë¡œ ë°°ì¹˜ */
Â  Â  Â  Â  Â  Â  left: 52%; /* ì¤‘ì•™ ì •ë ¬ */
Â  Â  Â  Â  Â  Â  bottom: -20vh; /* ì™„ì „ í•˜ë‹¨ */
Â  Â  Â  Â  Â  Â  transform: translateX(-50%); /* ì¤‘ì•™ ì •ë ¬ ë³´ì • */
Â  Â  Â  Â  Â  Â  z-index: 20;
Â  Â  Â  Â  Â  Â  transition: opacity 1.5s ease-out;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  /* ì „ë‹¬ ëª¨ë“œì—ì„œë§Œ ë“œë˜ê·¸ ì»¤ì„œë¡œ ë³€ê²½ */
Â  Â  Â  Â  #draggable-bouquet.delivery-mode {
Â  Â  Â  Â  Â  Â  cursor: grab;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- íŒŒë™ ì• ë‹ˆë©”ì´ì…˜ (Grab/Click Signal) --- */
Â  Â  Â  Â  @keyframes pulse {
Â  Â  Â  Â  Â  Â  0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
Â  Â  Â  Â  Â  Â  70% { box-shadow: 0 0 0 60px rgba(255, 255, 255, 0); }
Â  Â  Â  Â  Â  Â  100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
Â  Â  Â  Â  }

Â  Â  Â  Â  .pulse-target {
Â  Â  Â  Â  Â  Â  border-radius: 50%;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  Â  Â  position: absolute;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  width: 30px;
Â  Â  Â  Â  Â  Â  height: 30px;
Â  Â  Â  Â  Â  Â  background-color: rgba(255, 255, 255, 0.8);
Â  Â  Â  Â  Â  Â  animation: pulse 2s infinite;
Â  Â  Â  Â  Â  Â  z-index: 99;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* ì´ˆê¸° ì‹ í˜¸ ìœ„ì¹˜: ê½ƒë‹¤ë°œê³¼ ë™ì¼í•˜ê²Œ ì™„ì „ í•˜ë‹¨ */
Â  Â  Â  Â  #initial-signal {
Â  Â  Â  Â  Â  Â  bottom: 5vh; /* ê½ƒë‹¤ë°œì´ ìˆëŠ” ì˜ì—­ì— ë°°ì¹˜ */
Â  Â  Â  Â  Â  Â  top: auto !important; /* JSì˜ top ì„¤ì •ì„ ë¬´ì‹œ */
Â  Â  Â  Â  }

Â  Â  Â  Â  /* ì „ë‹¬ ëª©í‘œ ì§€ì  íŒŒë™ ìœ„ì¹˜ ì¡°ì • */
Â  Â  Â  Â  #target-signal {
Â  Â  Â  Â  Â  Â  Â bottom: 60% !important; /* ì „ë‹¬ ëª©í‘œ ì§€ì  (í™”ë©´ ì¤‘ì•™ ìƒë‹¨ ê·¼ì²˜) */
Â  Â  Â  Â  Â  Â  Â top: auto !important;
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- ì•ˆë‚´ ë©”ì‹œì§€ ë°•ìŠ¤ --- */
Â  Â  Â  Â  #guide-message {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  padding: 2vw 4vw;
Â  Â  Â  Â  Â  Â  background-color: rgba(0, 0, 0, 0.7);
Â  Â  Â  Â  Â  Â  color: #cdff45;
Â  Â  Â  Â  Â  Â  font-size: 1.5vw;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  z-index: 50;
Â  Â  Â  Â  Â  Â  opacity: 0;
Â  Â  Â  Â  Â  Â  transition: opacity 0.5s ease-in-out ;
Â  Â  Â  Â  Â  Â  pointer-events: none;
Â  Â  Â  Â  }

Â  Â  Â  Â  #guide-message.show {
Â  Â  Â  Â  Â  Â  opacity: 1;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* --- ì „ë‹¬ ì™„ë£Œ í™”ë©´ --- */
Â  Â  Â  Â  #completion-overlay {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background-color: rgba(0, 0, 0, 0.9);
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  z-index: 100;
Â  Â  Â  Â  }

Â  Â  Â  Â  #completion-box {
Â  Â  Â  Â  Â  Â  padding: 4vw 6vw;
Â  Â  Â  Â  Â  Â  background-color: rgba(0, 0, 0, 0.9);Â 
Â  Â  Â  Â  Â  Â  border: 1px solid #cdff45;
Â  Â  Â  Â  Â  Â  color: #cdff45;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-family: "argent-pixel-cf", sans-serif;
Â  Â  Â  Â  Â  Â  font-size: 3vw;
Â  Â  Â  Â  Â  Â  box-shadow: 0 0 30px rgba(205, 255, 69, 0.5);
Â  Â  Â  Â  Â  Â  display: flex;Â 
Â  Â  Â  Â  Â  Â  flex-direction: column;Â 
Â  Â  Â  Â  Â  Â  align-items: center;Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  #go-main-button {
Â  Â  Â  Â  Â  Â  padding: 1vw 5vw;
Â  Â  Â  Â  Â  Â  font-size: 2vw;
Â  Â  Â  Â  Â  Â  font-family: "argent-pixel-cf", sans-serif;
Â  Â  Â  Â  Â  Â  font-weight: 900;
Â  Â  Â  Â  Â  Â  font-style: regular;
Â  Â  Â  Â  Â  Â  color: #cdff45;
Â  Â  Â  Â  Â  Â  background: rgba(0, 0, 0, 0.434);
Â  Â  Â  Â  Â  Â  border: #cdff45 1px solid ;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: background 0.3s, color 0.3s;
Â  Â  Â  Â  Â  Â  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
Â  Â  Â  Â  Â  Â  margin-top: 4vw;;
Â  Â  Â  Â  }
Â  Â  Â  Â  #go-main-button:hover {
Â  Â  Â  Â  Â  Â  background: #cdff45;
Â  Â  Â  Â  Â  Â  color: rgb(0, 0, 0);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  </style>
Â  Â Â 
</head>
<body>
Â  Â  <video id="video-background" preload="auto" poster="walk_poster.jpg" playsinline muted>
Â  Â  Â  Â  <source src="walk.mp4" type="video/mp4">Â 
Â  Â  Â  Â  Your browser does not support the video tag.
Â  Â  </video>
Â  Â Â 
Â  Â  <div id="delivery-ui-wrapper">
Â  Â  Â  Â  <img id="draggable-bouquet" src="" alt="ë“œë˜ê·¸ ê°€ëŠ¥í•œ ê½ƒë‹¤ë°œ">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="initial-signal" class="pulse-target"></div>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div id="target-signal" class="pulse-target" style="opacity: 0; display: none;"></div>
Â  Â  Â  Â Â 
Â  Â  </div>

Â  Â  <div id="guide-message"></div>
Â  Â Â 
Â  Â  <div id="completion-overlay">
Â  Â  Â  Â  <div id="completion-box">
Â  Â  Â  Â  Â  Â  BOUQUET IS DELIVERED!
Â  Â  Â  Â  Â  Â  <button id="go-main-button">GO MAIN</button>
Â  Â  Â  Â  </div>
Â  Â  </div>

<script>
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  const video = document.getElementById('video-background');
Â  Â  Â  Â  const bouquetImg = document.getElementById('draggable-bouquet');
Â  Â  Â  Â  const initialSignal = document.getElementById('initial-signal');
Â  Â  Â  Â  const targetSignal = document.getElementById('target-signal');
Â  Â  Â  Â  const guideMessage = document.getElementById('guide-message');
Â  Â  Â  Â  const completionOverlay = document.getElementById('completion-overlay');
Â  Â  Â  Â  const goMainButton = document.getElementById('go-main-button');
Â  Â  Â  Â Â 
Â  Â  Â  Â  let isDragging = false;
Â  Â  Â  Â  let videoPlaying = false; // ë¹„ë””ì˜¤ ì¬ìƒ ì¤‘ ì—¬ë¶€ (ê±·ëŠ” ì¤‘)
Â  Â  Â  Â  let videoEnded = false; // ì˜ìƒ ì¢…ë£Œ ì—¬ë¶€ (ì „ë‹¬ ëª¨ë“œ)
Â  Â  Â  Â  let initialGuideCompleted = false; // ì´ˆê¸° ì•ˆë‚´ ì™„ë£Œ ì—¬ë¶€
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ğŸŒŸ Blob URL ë³€ìˆ˜ ì„ ì–¸ ë° ë°ì´í„° ë¡œë“œ ğŸŒŸ
Â  Â  Â  Â  const finalBouquetBlobURL = sessionStorage.getItem('finalBouquetImageURL');
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (!finalBouquetBlobURL) {
Â  Â  Â  Â  Â  Â  alert("ê½ƒë‹¤ë°œ ì´ë¯¸ì§€ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œì‘í•´ì£¼ì„¸ìš”.");
Â  Â  Â  Â  Â  Â  window.location.href = "love.html"; // ì ì ˆí•œ ì‹œì‘ í˜ì´ì§€ë¡œ ë³€ê²½
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  bouquetImg.src = finalBouquetBlobURL;Â 
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ------------------------------------------------------------------
Â  Â  Â  Â  // [1. ë©”ëª¨ë¦¬ í•´ì œ ë¡œì§ ì¶”ê°€]
Â  Â  Â  Â  // ------------------------------------------------------------------
Â  Â  Â  Â  const cleanupBlobURL = () => {
Â  Â  Â  Â  Â  Â  Â if (finalBouquetBlobURL) {
Â  Â  Â  Â  Â  Â  Â  Â  Â URL.revokeObjectURL(finalBouquetBlobURL);
Â  Â  Â  Â  Â  Â  Â  Â  Â sessionStorage.removeItem('finalBouquetImageURL');
Â  Â  Â  Â  Â  Â  Â  Â  Â console.log("ê½ƒë‹¤ë°œ Blob URL í•´ì œë¨.");
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  Â  Â  Â const letterBlobURL = sessionStorage.getItem('capturedLetterImageURL');
Â  Â  Â  Â  Â  Â  Â if (letterBlobURL) {
Â  Â  Â  Â  Â  Â  Â  Â  Â URL.revokeObjectURL(letterBlobURL);
Â  Â  Â  Â  Â  Â  Â  Â  Â sessionStorage.removeItem('capturedLetterImageURL');
Â  Â  Â  Â  Â  Â  Â  Â  Â console.log("í¸ì§€ì§€ Blob URL í•´ì œë¨.");
Â  Â  Â  Â  Â  Â  Â }
Â  Â  Â  Â  };

Â  Â  Â  Â  window.addEventListener('unload', cleanupBlobURL);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // [2. ì´ˆê¸° ì„¤ì •]
Â  Â  Â  Â  video.load(); // ì²« í”„ë ˆì„ì„ ë¡œë“œ
Â  Â  Â  Â  initialSignal.style.display = 'none';

Â  Â  Â  Â  // [3. ì•ˆë‚´ ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜]
Â  Â  Â  Â  const showGuide = (message, duration, callback) => {
Â  Â  Â  Â  Â  Â  guideMessage.textContent = message;
Â  Â  Â  Â  Â  Â  guideMessage.classList.add('show');
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  guideMessage.classList.remove('show');
Â  Â  Â  Â  Â  Â  Â  Â  if (callback) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(callback, 500);Â 
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }, duration);
Â  Â  Â  Â  };

Â  Â  Â  Â  // [4. ë¹„ë””ì˜¤ ì¬ìƒ ì‹œì‘ í•¨ìˆ˜ - í´ë¦­/í„°ì¹˜ ì‹œ í˜¸ì¶œ]
Â  Â  Â  Â  const startVideo = () => {
Â  Â  Â  Â  Â  Â  if (!initialGuideCompleted || videoPlaying || videoEnded) return;

Â  Â  Â  Â  Â  Â  videoPlaying = true;
Â  Â  Â  Â  Â  Â  video.play();
Â  Â  Â  Â  Â  Â  initialSignal.style.display = 'none'; // í´ë¦­ í›„ ì´ˆê¸° ì‹ í˜¸ ì œê±°
Â  Â  Â  Â  Â  Â  bouquetImg.style.cursor = 'default'; // ê±·ëŠ” ì¤‘ ë“œë˜ê·¸ ë°©ì§€
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ë¹„ë””ì˜¤ ì¬ìƒ ì¤‘ì—ëŠ” ë“œë˜ê·¸ ì´ë²¤íŠ¸ë¥¼ ë§‰ê¸° ìœ„í•´ ì„ì‹œë¡œ í•´ì œí•˜ê±°ë‚˜, ë“œë˜ê·¸ ë¡œì§ ë‚´ì—ì„œ ë¶„ê¸° ì²˜ë¦¬
Â  Â  Â  Â  Â  Â  // í˜„ì¬ëŠ” startDrag/doDrag ë‚´ì—ì„œ videoEndedì™€ videoPlaying ìƒíƒœë¥¼ í™•ì¸í•˜ì—¬ ë“œë˜ê·¸ë¥¼ ë§‰ìŒ
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  // [5. ë¹„ë””ì˜¤ ë ì´ë²¤íŠ¸]
Â  Â  Â  Â  video.onended = () => {
Â  Â  Â  Â  Â  Â  videoPlaying = false;
Â  Â  Â  Â  Â  Â  videoEnded = true;
Â  Â  Â  Â  Â  Â  // ë¹„ë””ì˜¤ ë í”„ë ˆì„ ìœ ì§€
Â  Â  Â  Â  Â  Â  video.pause();Â 
Â  Â  Â  Â  Â  Â  video.currentTime = video.duration;Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  showGuide("ìƒëŒ€ë°© ì•ì— ë„ì°©í–ˆì–´ìš”. ê½ƒë‹¤ë°œì„ ìƒëŒ€ì—ê²Œ ì „ë‹¬í•´ì£¼ì„¸ìš”! ğŸ’", 3000, () => {
Â  Â  Â  Â  Â  Â  Â  Â  // ì „ë‹¬ ëª¨ë“œ ì‹œì‘: ê½ƒë‹¤ë°œì„ ëŒì–´ì„œ ì¤‘ì•™ ëª©í‘œ ì§€ì ì— ë†“ë„ë¡ ì•ˆë‚´
Â  Â  Â  Â  Â  Â  Â  Â  targetSignal.style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  targetSignal.style.opacity = 1;
Â  Â  Â  Â  Â  Â  Â  Â  bouquetImg.classList.add('delivery-mode'); // ë“œë˜ê·¸ ì»¤ì„œ í™œì„±í™”
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  // [6. ë“œë˜ê·¸ ë¡œì§]
Â  Â  Â  Â  let offsetX, offsetY;

Â  Â  Â  Â  const startDrag = (e) => {
Â  Â  Â  Â  Â  Â  if (!videoEnded) return; // ë¹„ë””ì˜¤ê°€ ëë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ë“œë˜ê·¸ ë¶ˆê°€ëŠ¥
Â  Â  Â  Â  Â  Â  if (isDragging) return; 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  isDragging = true;
Â  Â  Â  Â  Â  Â  bouquetImg.style.cursor = 'grabbing';
Â  Â  Â  Â  Â  Â  targetSignal.style.opacity = 0; // ë“œë˜ê·¸ ì‹œì‘ ì‹œ ëª©í‘œ ì‹ í˜¸ í˜ì´ë“œ ì•„ì›ƒ
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const rect = bouquetImg.getBoundingClientRect();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // í„°ì¹˜ ì´ë²¤íŠ¸ ëŒ€ì‘
Â  Â  Â  Â  Â  Â  const clientX = e.type.startsWith('touch') ? e.touches[0].clientX : e.clientX;
Â  Â  Â  Â  Â  Â  const clientY = e.type.startsWith('touch') ? e.touches[0].clientY : e.clientY;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  offsetX = clientX - rect.left;
Â  Â  Â  Â  Â  Â  offsetY = clientY - rect.top;

Â  Â  Â  Â  Â  Â  // ë“œë˜ê·¸ ì‹œì‘ ì‹œì ì˜ ìœ„ì¹˜ë¥¼ ì ˆëŒ€ê°’(fixed)ìœ¼ë¡œ ê³ ì •
Â  Â  Â  Â  Â  Â  bouquetImg.style.position = 'fixed';
Â  Â  Â  Â  Â  Â  bouquetImg.style.left = `${clientX - offsetX}px`;
Â  Â  Â  Â  Â  Â  bouquetImg.style.top = `${clientY - offsetY}px`;
Â  Â  Â  Â  Â  Â  bouquetImg.style.bottom = 'auto'; // bottom í•´ì œ
Â  Â  Â  Â  Â  Â  bouquetImg.style.transform = 'none';
Â  Â  Â  Â  };

Â  Â  Â  Â  const doDrag = (e) => {
Â  Â  Â  Â  Â  Â  if (!isDragging || !videoEnded) return; // ë“œë˜ê·¸ ëª¨ë“œê°€ ì•„ë‹ˆê±°ë‚˜ ë¹„ë””ì˜¤ê°€ ëë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ë¬´ì‹œ

Â  Â  Â  Â  Â  Â  e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€ (í„°ì¹˜ í™˜ê²½)

Â  Â  Â  Â  Â  Â  const clientX = e.type.startsWith('touch') ? e.touches[0].clientX : e.clientX;
Â  Â  Â  Â  Â  Â  const clientY = e.type.startsWith('touch') ? e.touches[0].clientY : e.clientY;

Â  Â  Â  Â  Â  Â  let newX = clientX - offsetX;
Â  Â  Â  Â  Â  Â  let newY = clientY - offsetY;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  bouquetImg.style.left = `${newX}px`;
Â  Â  Â  Â  Â  Â  bouquetImg.style.top = `${newY}px`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // ì „ë‹¬ ëª¨ë“œ: ì¤‘ì•™ ì „ë‹¬ ì§€ì  ë„ë‹¬ í™•ì¸
Â  Â  Â  Â  Â  Â  const targetCenterX = window.innerWidth / 2;
Â  Â  Â  Â  Â  Â  // target-signalì˜ CSS bottom: 60%ì— ë§ì¶° yì¶• ëª©í‘œ ì§€ì  ì„¤ì • (top: 40%ì™€ ìœ ì‚¬)
Â  Â  Â  Â  Â  Â  const targetCenterY = window.innerHeight * (1 - 0.6);Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const bouquetCenterX = newX + (bouquetImg.offsetWidth / 2);
Â  Â  Â  Â  Â  Â  const bouquetCenterY = newY + (bouquetImg.offsetHeight / 2);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const distance = Math.sqrt(
Â  Â  Â  Â  Â  Â  Â  Â  Math.pow(bouquetCenterX - targetCenterX, 2) +Â 
Â  Â  Â  Â  Â  Â  Â  Â  Math.pow(bouquetCenterY - targetCenterY, 2)
Â  Â  Â  Â  Â  Â  );

Â  Â  Â  Â  Â  Â  // ì¤‘ì•™ ì§€ì (ì•½ 100px ë°˜ê²½)ì— ë„ë‹¬í•˜ë©´ ì™„ë£Œ
Â  Â  Â  Â  Â  Â  if (distance < 100) {
Â  Â  Â  Â  Â  Â  Â  Â  finishDeliverySequence();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  const stopDrag = () => {
Â  Â  Â  Â  Â  Â  if (!isDragging || !videoEnded) return; // ë¹„ë””ì˜¤ê°€ ëë‚˜ì§€ ì•Šì•˜ìœ¼ë©´ ë“œë˜ê·¸ë¥¼ ë©ˆì¶°ë„ ì•„ë¬´ ì¼ë„ ì—†ìŒ
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  isDragging = false;
Â  Â  Â  Â  Â  Â  bouquetImg.style.cursor = 'grab'; // ì „ë‹¬ ëª¨ë“œ ìœ ì§€
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ë“œë˜ê·¸ë¥¼ ë†“ì•˜ì„ ë•Œ ì›ë˜ ìœ„ì¹˜ë¡œ ëŒì•„ê°€ë„ë¡ ê°•ì œí•˜ì§€ ì•ŠìŒ (ì „ë‹¬ ì˜ë„ ìœ ì§€)
Â  Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  Â  // ëª©í‘œ ì‹ í˜¸ê°€ ì‚¬ë¼ì§„ ìƒíƒœë¼ë©´ ë‹¤ì‹œ í‘œì‹œ
Â  Â  Â  Â  Â  Â  if (targetSignal.style.opacity == 0) {
Â  Â  Â  Â  Â  Â  Â  Â  targetSignal.style.opacity = 1;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  // [7. ìµœì¢… ì „ë‹¬ ì™„ë£Œ ì‹œí€€ìŠ¤]
Â  Â  Â  Â  const finishDeliverySequence = () => {
Â  Â  Â  Â  Â  Â  // ëª¨ë“  ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì œê±° (ì¤‘ìš”)
Â  Â  Â  Â  Â  Â  document.removeEventListener('mousemove', doDrag);
Â  Â  Â  Â  Â  Â  document.removeEventListener('mouseup', stopDrag);
Â  Â  Â  Â  Â  Â  document.removeEventListener('touchmove', doDrag);
Â  Â  Â  Â  Â  Â  document.removeEventListener('touchend', stopDrag);
Â  Â  Â  Â  Â  Â  bouquetImg.removeEventListener('mousedown', startDrag);
Â  Â  Â  Â  Â  Â  bouquetImg.removeEventListener('touchstart', startDrag);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  isDragging = false;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 1. í˜ì´ë“œ ì•„ì›ƒ ì‹œì‘
Â  Â  Â  Â  Â  Â  bouquetImg.style.opacity = 0;Â 
Â  Â  Â  Â  Â  Â  targetSignal.style.display = 'none';
Â  Â  Â  Â  Â  Â  guideMessage.classList.remove('show');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // 2. 1.5ì´ˆ í›„ ì™„ë£Œ ì˜¤ë²„ë ˆì´ í‘œì‹œ
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  completionOverlay.style.display = 'flex';
Â  Â  Â  Â  Â  Â  Â  Â  // ğŸŒŸ ì „ë‹¬ì´ ì™„ë£Œëœ í›„ì— Blob URL í•´ì œ ğŸŒŸ
Â  Â  Â  Â  Â  Â  Â  Â  cleanupBlobURL();Â 
Â  Â  Â  Â  Â  Â  }, 1500);Â 
Â  Â  Â  Â  };

Â  Â  Â  Â  // [8. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²° ë° ë¶„ë¦¬]
Â  Â  Â  Â  
Â  Â  Â  Â  // ê±·ê¸° ì‹œì‘ (í´ë¦­/í„°ì¹˜) ì´ë²¤íŠ¸ (ë¹„ë””ì˜¤ ì¬ìƒ)
Â  Â  Â  Â  // NOTE: bodyì— ì´ë²¤íŠ¸ë¥¼ ê±¸ë©´ ë¹„ë””ì˜¤ê°€ ì•„ë‹Œ ìš”ì†Œë¥¼ í´ë¦­í•´ë„ ì¬ìƒë˜ë¯€ë¡œ, ê½ƒë‹¤ë°œ ì´ë¯¸ì§€ì—ë§Œ ê±¸ì–´ì¤ë‹ˆë‹¤.
Â  Â  Â  Â  const videoStartListener = (e) => {
Â  Â  Â  Â  Â  Â  if (initialGuideCompleted && !videoPlaying && !videoEnded) {
Â  Â  Â  Â  Â  Â  Â  Â  startVideo();
Â  Â  Â  Â  Â  Â  Â  Â  // ë¹„ë””ì˜¤ ì¬ìƒì´ ì‹œì‘ë˜ë©´ ì´ ë¦¬ìŠ¤ë„ˆëŠ” ì œê±°
Â  Â  Â  Â  Â  Â  Â  Â  bouquetImg.removeEventListener('click', videoStartListener);
Â  Â  Â  Â  Â  Â  Â  Â  bouquetImg.removeEventListener('touchstart', videoStartListener);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
Â  Â  Â  Â  bouquetImg.addEventListener('click', videoStartListener);
Â  Â  Â  Â  bouquetImg.addEventListener('touchstart', videoStartListener, { passive: true });

Â  Â  Â  Â  // ì „ë‹¬ ëª¨ë“œ ë“œë˜ê·¸ ì´ë²¤íŠ¸ (ë¹„ë””ì˜¤ ëë‚œ í›„)
Â  Â  Â  Â  bouquetImg.addEventListener('mousedown', startDrag);
Â  Â  Â  Â  document.addEventListener('mousemove', doDrag);
Â  Â  Â  Â  document.addEventListener('mouseup', stopDrag);
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ëª¨ë°”ì¼ í„°ì¹˜ ì´ë²¤íŠ¸
Â  Â  Â  Â  bouquetImg.addEventListener('touchstart', startDrag, { passive: false });
Â  Â  Â  Â  document.addEventListener('touchmove', doDrag, { passive: false });
Â  Â  Â  Â  document.addEventListener('touchend', stopDrag);


Â  Â  Â  Â  // ë²„íŠ¼ ì´ë²¤íŠ¸
Â  Â  Â  Â  goMainButton.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  window.location.href = "index.html";
Â  Â  Â  Â  });

Â  Â  Â  Â Â 
Â  Â  Â  Â  // [9. ì´ˆê¸° ì•ˆë‚´ ë©”ì‹œì§€]
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  // ì•ˆë‚´ ë©”ì‹œì§€ ìˆ˜ì •: "ì¡ê³  ê±¸ìœ¼ì„¸ìš”" -> "ì¡ê³  í´ë¦­/í„°ì¹˜í•˜ì—¬ ê±¸ìœ¼ì„¸ìš”" ë˜ëŠ” "í„°ì¹˜í•˜ì—¬ ê±¸ìœ¼ì„¸ìš”"
Â  Â  Â  Â  Â  Â  showGuide("ì € ì•ì— ìƒëŒ€ë°©ì´ ê¸°ë‹¤ë¦¬ê³  ìˆì–´ìš”. ê½ƒë‹¤ë°œì„ **í´ë¦­ ë˜ëŠ” í„°ì¹˜í•˜ì—¬** ê±¸ì–´ê°€ì„¸ìš”.", 4000, () => {
Â  Â  Â  Â  Â  Â  Â  Â  initialGuideCompleted = true; // ì´ˆê¸° ì•ˆë‚´ ì™„ë£Œ
Â  Â  Â  Â  Â  Â  Â  Â  initialSignal.style.display = 'block'; // ì´ˆê¸° í´ë¦­/í„°ì¹˜ ì‹ í˜¸ í‘œì‹œ
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }, 1000);
Â  Â  });
</script>
</body>
</html>
